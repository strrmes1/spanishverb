import streamlit as st
import random
import json
import datetime
from typing import Dict, List, Tuple

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã
st.set_page_config(
    page_title="üá™üá∏ –¢—Ä–µ–Ω–∞–∂–µ—Ä –∏—Å–ø–∞–Ω—Å–∫–∏—Ö –≥–ª–∞–≥–æ–ª–æ–≤",
    page_icon="üá™üá∏",
    layout="centered",
    initial_sidebar_state="collapsed"
)

# CSS –¥–ª—è –º–æ–±–∏–ª—å–Ω–æ–π –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏
st.markdown("""
<style>
    /* –û–±—â–∏–µ —Å—Ç–∏–ª–∏ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ */
    @media (max-width: 768px) {
        .main > div {
            padding-left: 1rem;
            padding-right: 1rem;
        }
        
        /* –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä –∫–Ω–æ–ø–æ–∫ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö */
        .stButton > button {
            height: 3rem;
            font-size: 1.1rem;
        }
        
        /* –£–ª—É—á—à–∞–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ */
        [data-testid="metric-container"] {
            border: 1px solid #e0e0e0;
            padding: 0.5rem;
            border-radius: 0.5rem;
            margin-bottom: 0.5rem;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ –≥–ª–∞–≥–æ–ª–æ–≤ */
        .verb-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem 1rem;
            border-radius: 1rem;
            text-align: center;
            margin: 1rem 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .verb-title {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }
        
        .verb-translation {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 1rem;
        }
        
        .pronoun-display {
            font-size: 1.8rem;
            font-weight: bold;
            margin: 1rem 0;
            background: rgba(255,255,255,0.2);
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            display: inline-block;
        }
        
        .answer-display {
            font-size: 2rem;
            font-weight: bold;
            background: rgba(255,255,255,0.9);
            color: #2d5e3e;
            padding: 1rem;
            border-radius: 0.5rem;
            margin: 1rem 0;
        }
    }
    
    /* –î–ª—è –±–æ–ª—å—à–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤ */
    @media (min-width: 769px) {
        .verb-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 3rem 2rem;
            border-radius: 1rem;
            text-align: center;
            margin: 1rem 0;
            box-shadow: 0 8px 30px rgba(0,0,0,0.1);
        }
        
        .verb-title {
            font-size: 3rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }
        
        .verb-translation {
            font-size: 1.4rem;
            opacity: 0.9;
            margin-bottom: 1.5rem;
        }
        
        .pronoun-display {
            font-size: 2rem;
            font-weight: bold;
            margin: 1.5rem 0;
            background: rgba(255,255,255,0.2);
            padding: 0.8rem 1.5rem;
            border-radius: 0.5rem;
            display: inline-block;
        }
        
        .answer-display {
            font-size: 2.5rem;
            font-weight: bold;
            background: rgba(255,255,255,0.9);
            color: #2d5e3e;
            padding: 1.5rem;
            border-radius: 0.5rem;
            margin: 1.5rem 0;
        }
    }
    
    /* –°–∫—Ä—ã—Ç–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ Streamlit */
    #MainMenu {visibility: hidden;}
    footer {visibility: hidden;}
    header {visibility: hidden;}
    
    /* –£–ª—É—á—à–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è selectbox –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö */
    .stSelectbox > div > div {
        font-size: 1.1rem;
    }
</style>
""", unsafe_allow_html=True)

# –î–∞–Ω–Ω—ã–µ –≥–ª–∞–≥–æ–ª–æ–≤
VERBS = {
    'ser': {'translation': '–±—ã—Ç—å, —è–≤–ª—è—Ç—å—Å—è', 'type': 'irregular'},
    'estar': {'translation': '–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è, –±—ã—Ç—å', 'type': 'irregular'},
    'tener': {'translation': '–∏–º–µ—Ç—å', 'type': 'irregular'},
    'hacer': {'translation': '–¥–µ–ª–∞—Ç—å', 'type': 'irregular'},
    'decir': {'translation': '–≥–æ–≤–æ—Ä–∏—Ç—å, —Å–∫–∞–∑–∞—Ç—å', 'type': 'irregular'},
    'ir': {'translation': '–∏–¥—Ç–∏, –µ—Ö–∞—Ç—å', 'type': 'irregular'},
    'ver': {'translation': '–≤–∏–¥–µ—Ç—å', 'type': 'irregular'},
    'dar': {'translation': '–¥–∞–≤–∞—Ç—å', 'type': 'irregular'},
    'saber': {'translation': '–∑–Ω–∞—Ç—å', 'type': 'irregular'},
    'querer': {'translation': '—Ö–æ—Ç–µ—Ç—å, –ª—é–±–∏—Ç—å', 'type': 'irregular'},
    'llegar': {'translation': '–ø—Ä–∏–±—ã–≤–∞—Ç—å, –ø—Ä–∏—Ö–æ–¥–∏—Ç—å', 'type': 'regular-ar'},
    'pasar': {'translation': '–ø—Ä–æ—Ö–æ–¥–∏—Ç—å, –ø—Ä–æ–≤–æ–¥–∏—Ç—å', 'type': 'regular-ar'},
    'deber': {'translation': '–±—ã—Ç—å –¥–æ–ª–∂–Ω—ã–º', 'type': 'regular-er'},
    'poner': {'translation': '–∫–ª–∞—Å—Ç—å, —Å—Ç–∞–≤–∏—Ç—å', 'type': 'irregular'},
    'parecer': {'translation': '–∫–∞–∑–∞—Ç—å—Å—è', 'type': 'irregular'},
    'quedar': {'translation': '–æ—Å—Ç–∞–≤–∞—Ç—å—Å—è', 'type': 'regular-ar'},
    'creer': {'translation': '–≤–µ—Ä–∏—Ç—å, —Å—á–∏—Ç–∞—Ç—å', 'type': 'regular-er'},
    'hablar': {'translation': '–≥–æ–≤–æ—Ä–∏—Ç—å', 'type': 'regular-ar'},
    'llevar': {'translation': '–Ω–æ—Å–∏—Ç—å, –Ω–µ—Å—Ç–∏', 'type': 'regular-ar'},
    'dejar': {'translation': '–æ—Å—Ç–∞–≤–ª—è—Ç—å', 'type': 'regular-ar'},
    'seguir': {'translation': '—Å–ª–µ–¥–æ–≤–∞—Ç—å, –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å', 'type': 'irregular'},
    'encontrar': {'translation': '–Ω–∞—Ö–æ–¥–∏—Ç—å, –≤—Å—Ç—Ä–µ—á–∞—Ç—å', 'type': 'irregular'},
    'llamar': {'translation': '–∑–≤–∞—Ç—å, –Ω–∞–∑—ã–≤–∞—Ç—å', 'type': 'regular-ar'},
    'venir': {'translation': '–ø—Ä–∏—Ö–æ–¥–∏—Ç—å', 'type': 'irregular'},
    'pensar': {'translation': '–¥—É–º–∞—Ç—å', 'type': 'irregular'},
    'salir': {'translation': '–≤—ã—Ö–æ–¥–∏—Ç—å', 'type': 'irregular'},
    'vivir': {'translation': '–∂–∏—Ç—å', 'type': 'regular-ir'},
    'sentir': {'translation': '—á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å', 'type': 'irregular'},
    'trabajar': {'translation': '—Ä–∞–±–æ—Ç–∞—Ç—å', 'type': 'regular-ar'},
    'estudiar': {'translation': '–∏–∑—É—á–∞—Ç—å', 'type': 'regular-ar'}
}

PRONOUNS = ['yo', 't√∫', '√©l/ella', 'nosotros', 'vosotros', 'ellos/ellas']

CONJUGATIONS = {
    'presente': {
        'ser': ['soy', 'eres', 'es', 'somos', 'sois', 'son'],
        'estar': ['estoy', 'est√°s', 'est√°', 'estamos', 'est√°is', 'est√°n'],
        'tener': ['tengo', 'tienes', 'tiene', 'tenemos', 'ten√©is', 'tienen'],
        'hacer': ['hago', 'haces', 'hace', 'hacemos', 'hac√©is', 'hacen'],
        'decir': ['digo', 'dices', 'dice', 'decimos', 'dec√≠s', 'dicen'],
        'ir': ['voy', 'vas', 'va', 'vamos', 'vais', 'van'],
        'ver': ['veo', 'ves', 've', 'vemos', 'veis', 'ven'],
        'dar': ['doy', 'das', 'da', 'damos', 'dais', 'dan'],
        'saber': ['s√©', 'sabes', 'sabe', 'sabemos', 'sab√©is', 'saben'],
        'querer': ['quiero', 'quieres', 'quiere', 'queremos', 'quer√©is', 'quieren'],
        'llegar': ['llego', 'llegas', 'llega', 'llegamos', 'lleg√°is', 'llegan'],
        'pasar': ['paso', 'pasas', 'pasa', 'pasamos', 'pas√°is', 'pasan'],
        'deber': ['debo', 'debes', 'debe', 'debemos', 'deb√©is', 'deben'],
        'poner': ['pongo', 'pones', 'pone', 'ponemos', 'pon√©is', 'ponen'],
        'parecer': ['parezco', 'pareces', 'parece', 'parecemos', 'parec√©is', 'parecen'],
        'quedar': ['quedo', 'quedas', 'queda', 'quedamos', 'qued√°is', 'quedan'],
        'creer': ['creo', 'crees', 'cree', 'creemos', 'cre√©is', 'creen'],
        'hablar': ['hablo', 'hablas', 'habla', 'hablamos', 'habl√°is', 'hablan'],
        'llevar': ['llevo', 'llevas', 'lleva', 'llevamos', 'llev√°is', 'llevan'],
        'dejar': ['dejo', 'dejas', '